<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Electric-Gas-Heat Coordination | Shengfei "Gabriel" Yin, Ph.D. </title> <meta name="author" content="Shengfei " gabriel yin ph.d.> <meta name="description" content="Energy hub scheduling with multiple energy networks"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link rel="preconnect" href="https://fonts.googleapis.com"> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&amp;display=swap" rel="stylesheet"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/header.jpg?16b05208e045b41ff2d6126c8b8815f2"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://gabrieledogawa.github.io/work_life/electric_gas_heat_coordination/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Shengfei</span> "Gabriel" Yin, Ph.D. </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">Me </a> </li> <li class="nav-item active"> <a class="nav-link" href="/work_life/">Work &amp; Life <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item "> <a class="nav-link" href="/family/">Family </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Electric-Gas-Heat Coordination</h1> <p class="post-description">Energy hub scheduling with multiple energy networks</p> </header> <article> <p>Electric-gas-heat network is a very common energy hub infrastructure in the microgrid (usually referred to as part of the future smart cities). They are co-related to each other since one type of energy could be easily converted to another, so a global scheduler or controller for these energy types is often warranted in the microgrid study. One might argue that a distributed control mechanism for each energy type might fit more with the distribution system since the decentralization is the main idea of adopting microgrid. However, it should be suggested that a central controller for the energy hub is more efficient considering the relatively small size of the problem and the concept of “fewer local bureaucratics”.</p> <p>This project is funded by <a href="https://www.linkedin.com/company/geiri-north-america/" rel="external nofollow noopener" target="_blank">GEIRI-NA</a>, which is currently closed due to Chinese local policies. We work closely with the former Senior Researcher <a href="https://www.linkedin.com/in/xiaohu-zhang-05593a56/" rel="external nofollow noopener" target="_blank">Dr. Xiaohu Zhang</a>, who is now the Principal Machine Learning Scientist at Plus Power and the former Research Director <a href="https://dishi.netlify.app/" rel="external nofollow noopener" target="_blank">Dr. Di Shi</a>, who is now an Associate Professor at New Mexico State University.</p> <p>This research involves the co-simulation and scheduling of the generating units, energy storage systems (including all the electric, gas, and heat storage systems), and renewable assets from a distributed microgrid in the wholesale energy market operation. We need a comprehensive modeling of the triumvirate of electric, gas, and heat networks to fully capture the energy flow inside the energy hub. We will discuss them in details in the following sections.</p> <h2 id="electric-network">Electric Network</h2> <p>In the electric network modeling, I used the DistFlow model (explained well in <a href="https://chrisyeh96.github.io/2023/03/28/simplified-distflow.html" rel="external nofollow noopener" target="_blank">this post</a>), which is commonly used in the operation and optimization of electrical distribution systems. It is a set of equations that describe the flow of power in a radial distribution network. It models the relationship between power injections, power flows, and voltages along the distribution lines.</p> \[v_{i,t}-v_{j,t}=\frac{r_{\ell}p_{\ell,t}+x_{\ell}q_{\ell,t}}{V_0},\] <p>where \(v_{(i,j),t}\) denotes the voltage of bus \(i\) or \(j\) at timestep \(t\), \(r_{\ell}\) and \(x_{\ell}\) denote resistance and reactance of line \(\ell\) (connecting \(i\) and \(j\)), and \(p_{\ell,t}\) and \(q_{\ell,t}\) denote active and reactive power flow of line \(\ell\) at timestep \(t\). Using this equation together with capacity/voltage limit constraints and power balance equation, we could approximate the distribution-level power flow and thus model the network.</p> <h2 id="gas-network">Gas Network</h2> <p>The gas network flow problem is highly nonlinear due to the notorious <a href="https://www.webbusterz.org/weymouth-equation-for-flow-rate-calculation/" rel="external nofollow noopener" target="_blank">Weymouth equations</a>. A common way to do this is to use the second-order cone program to convexify the nonlinearity.</p> \[(1-\alpha^c)u_{\ell,t}^{in} = u_{\ell,t}^{out},\] \[\omega_{j,t}\leq \gamma_c\cdot \omega_{i,t}\] \[u_{\ell,t}^2 \leq \theta\cdot(\omega_{i,t}^2-\omega_{j,t}^2),\] <p>where \(\alpha_c/\gamma_c\) denote the gas/inflow compressor factors, \(\omega_{(i,j),t}\) denotes the gas nodal pressure of node \(i\) or \(j\) at timestep \(t\), \(u_{\ell,t}\) denotes the gas pipeline flow of pipeline \(\ell\) (connecting \(i\) and \(j\)) at timestep \(t\), and \(theta\) is the Weymouth coefficient. The second inequality formulates a second-order cone in the constraint space.</p> <p>Alternatively, there is another way, which is far more straightforward, to actually linearize the Waymouth equation. The figure below depicts the overall idea of this linearization. The solid curve AC is the original Weymouth curve, and we use the dashed curve AC to approximate the accurate Weymouth curve. The accuracy of this approximation is guaranteed based on the assumption that the maximum allowable pressure of the initial node of the pipeline is no smaller than that of the terminal node. We also argue that the pressure lower bound of gas nodes are all the same, but the pressure upper bound of gas nodes are different, which creates an asymmetric line (AB). Thus, we make an extension to the third quadrant to make a symmetric line (AC).</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/geirina/Weymouth-480.webp 480w,/assets/img/geirina/Weymouth-800.webp 800w,/assets/img/geirina/Weymouth-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/geirina/Weymouth.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="linearized_weymouth" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Weymouth Equation Linearization </div> <p>Using this approximation, we render the linearized version of the Weymouth equation as below.</p> \[(1-\alpha^c)u_{\ell,t}^{in} = u_{\ell,t}^{out},\] \[\omega_{j,t}^2 \leq \gamma_c^2\cdot \omega_{i,t}^2 ,\] \[\omega_{i,t}^2 - \omega_{j,t}^2 = u_{\ell,t}\cdot \sqrt{\frac{\omega_{i,t}^{\max} - \omega_{j,t}^{\min}}{\theta}}.\] <h2 id="heat-network">Heat Network</h2> <p>The heat network is also a very complicated energy network. The heat network consists of symmetric supply and return pipelines, and the figure below shows a typical topology of the heat system. At each source (load) node, heat is injected into (withdrawn from) the network via a heat exchanger between the supply side and the return side. The network model obeys the hydraulic conditions and thermal conditions.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/geirina/heat-480.webp 480w,/assets/img/geirina/heat-800.webp 800w,/assets/img/geirina/heat-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/geirina/heat.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="linearized_heat" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Heat network structure </div> <p>Hydraulic conditions describe the continuity of mass flows. For each node, the mass flow entering the node is equal to the mass flow leaving the node.</p> \[\sum_{b \in S_i^{P, e}} m_{b, t}^{p, s}+\sum_{j \in S_i^S} m_{j, t}^S=\sum_{b \in S_i^{P, s}} m_{b, t}^{p, s}+\sum_{k \in S_i^L} m_{k, t}^L\] \[\sum_{b \in S_i^{P, e}} m_{b, t}^{p, r}+\sum_{j \in S_i^L} m_{j, t}^L=\sum_{b \in S_i^{P, s}} m_{b, t}^{p, r}+\sum_{k \in S_i^S} m_{k, t}^S\] <p>We leave the notation at the end of this section. Thermal conditions characterize the relationship among nodal temperatures and thermal energy productions/consumptions, and consist of the following constraints. Thermal energy provided by the combined heat and power (CHP) unit is</p> \[h_{i, t}^S=c_p m_{i, t}^S\left(\tau s_{i, t}^S-\tau r_{i, t}^S\right)\] <p>Heat consumption at a load node is</p> \[h_{i, t}^L=c_p m_{i, t}^L\left(\tau s_{i, t}^L-\tau r_{i, t}^L\right)\] <p>Temperature at confluence nodes satisfy</p> \[\sum_{b \in S_i^{p, e}}\left(\tau s_{b, t}^{p, o} m_{b, t}^{p, s}\right)+\sum_{j \in S_i^S}\left(\tau s_{j, t}^S m_{j, t}^S\right)=\tau s_{i, t}^n\left(\sum_{b \in S_i^{p, e}} m_{b, t}^{p, s}+\sum_{j \in S_i^s} m_{j, t}^S\right)\] \[\sum_{b \in S_i^{P, s}}\left(\tau r_{b, t}^{p, o} m_{b, t}^{p, r}\right)+\sum_{k \in S_i^L}\left(\tau r_{k, t}^L m_{j, t}^S\right)=\tau s_{i, t}^n\left(\sum_{b \in S_i^{P, e}} m_{b, t}^{p, s}+\sum_{j \in S_i^S} m_{j, t}^S\right)\] <p>Due to inevitable heat loss, the temperature of fluid in pipelines drops along the flow direction. The relationship between inlet and outlet temperatures of each pipeline is established as</p> \[\tau s_{b, t}^{p, o}=\left(\tau s_{b, t}^{p, i}-T_t^a\right) e^{\frac{\lambda_b L_b}{c_p m_{b, t}^{p s}}}+T_t^a\] \[\tau r_{b, t}^{p, o}=\left(\tau r_{b, t}^{p, i}-T_t^a\right) e^{\frac{\lambda_b L_b}{C_p m_{b, t}^{p, r}}}+T_t^a\] <p>The heat loss in a pipeline is expressed as follows</p> \[\Delta Q_t^b=C_p m_{b, t}^p\left[\left(\tau_{b, t}^{p, i}-\tau_{b, t}^{p, o}\right)\right]\] <p>Due to the bilinear and exponential nature in the above equations, the above model is nonlinear. Here, I use a heuristic method to approximate the nonlinear constraints. It is observed that when mass flow variables are fixed, the thermal constraints in the heat system become linear. The heuristic variable temperature constant flow (VT-CF) can determine the near-optimal mass flow rate (MFR) based on network loss analysis. To do so, we first substitute the above three equations to obtain</p> \[\Delta Q_t^b=C_p m_{b, t}^p\left[\left(\tau_{b, t}^{p, i}-\tau_{b, t}^{p, o}\right)\left(1-e^{-\frac{\lambda_b L_b}{C_p m_{b, t}^{p, \tau}}}\right)\right]\] <p>where \(0&lt;\frac{\lambda_b L_b}{c_p m_{b, t}^{p, r}} \ll 1\). Since \(e^{-x} \approx 1-x\), we have</p> \[\Delta Q_t^b=C_p m_{b, t}^p\left(\tau_{b, t}^{p, i}-T_t^a\right) \frac{\lambda_b L_b}{C_p m_{b, t}^{p, r}}=\lambda_b L_b\left(\tau_{b, t}^{p, i}-T_t^a\right)\] <p>This equation suggests that \(\Delta Q_t^b\) is independent of MFR \(m_{b,t}^p\). Hence, by fixing MFR, the above heat system operation model is a linear program. Then, I use a heuristic two-step hydraulic-thermal decomposition to find a near-optimal solution with good quality. The workflow is summarized below.</p> <ul> <li>Step 1: Set all pipeline temperatures to the lower limits and calculate the heat loss.</li> <li>Step 2: Calculate the required heat sources by the summation of heat demand and the calculated heat loss. Then calculate the heat source and heat load MFR per their models.</li> <li>Step 3: Calculate the pipeline MFR per the MFR balance equations.</li> <li>Step 4: Fix all MFR variables, then perform the optimization.</li> </ul> <p>The following table provides all the notations throughout this subsection.</p> <table> <thead> <tr> <th>Variables</th> <th>Notations</th> </tr> </thead> <tbody> <tr> <td>\(p_{h,t}\)</td> <td>Power produced from CHP unit \(h\) at timestep \(t\)</td> </tr> <tr> <td>\(h_{h,t}\)</td> <td>Heat energy produced from CHP unit \(h\) at timestep \(t\)</td> </tr> <tr> <td>\(m_{b, t}^{p, s} / m_{b, t}^{p, r}\)</td> <td>Mass flow rate in supply/return pipeline</td> </tr> <tr> <td>\(m_{i, t}^S / m_{i, t}^L\)</td> <td>Mass flow rate in heat source/load</td> </tr> <tr> <td>\(\tau r_{b, t}^{p, i} / \tau r_{b, t}^{p, o}\)</td> <td>Temperature at inlet/outlet of the return pipeline</td> </tr> <tr> <td>\(\tau s_{b, t}^{p, i} / \tau S_{b, t}^{p, o}\)</td> <td>Temperature at inlet/outlet of the supply pipeline</td> </tr> <tr> <td>\(\tau s_{i, t}^S / \tau s_{i, t}^S\)</td> <td>Supply/return temperature of heat source</td> </tr> <tr> <td>\(\tau s_{b, t}^L / \tau r_{b, t}^L\)</td> <td>Supply/return temperature of heat load</td> </tr> <tr> <td>\(\tau s_{i, t}^n / \tau r_{i, t}^n\)</td> <td>Mixture temperature at supply/return node</td> </tr> </tbody> </table> <table> <thead> <tr> <th>Parameters</th> <th>Notations</th> </tr> </thead> <tbody> <tr> <td>\(C_p\)</td> <td>Specific heat capacity of water</td> </tr> <tr> <td>\(h_{i,t}^{L}\)</td> <td>Energy demand of heat load</td> </tr> <tr> <td>\(L_b\)</td> <td>Length of pipeline</td> </tr> <tr> <td>\(T^a_t\)</td> <td>Ambient temperature at timestep \(t\)</td> </tr> <tr> <td>\(\lambda_b\)</td> <td>Heat transfer coefficient of pipeline</td> </tr> </tbody> </table> <p><br> After modeling all the electric, gas, and heat networks, I added generating unit modeling and energy storage system modeling for all energy types, then performed the simulation on multiple scenarios to confirm the efficacy of the proposed model.</p> <h3 id="further-works">Further Works</h3> <p>I further extend this research to a transmission and distribution system coordination problem considering the uncertainties brought in the microgrid since abundant wind and solar energy are in the local energy hub. I leveraged the distributionally robust optimization to account for those uncertainties while devising a novel ADMM-like algorithm to efficiently solve it. Interested readers could refer to this <a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=9925642" rel="external nofollow noopener" target="_blank">paper</a>.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Shengfei Yin. Last updated: October 08, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>